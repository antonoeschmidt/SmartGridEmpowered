@startuml withdraw battery
start
:subtractBatteryCharge(amount, ots, nextOtsHash);
if (hash(ots) == otsHash) then (true)
:set otsHash = nextHash;
    if (batteryCharge >= amount) then (true)
        :set charge -= amount;
        :return true;
        stop
    else (false)
        :return false;
        stop
    endif
else (false)
    :return false;
    stop
endif
' stop
@enduml